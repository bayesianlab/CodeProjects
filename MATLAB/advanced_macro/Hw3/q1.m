clear 
clc
sigma = .3;
sigmae = 1;
sigmaeta1 = 1;
sigmaeta2 = 1;
sigmaeta3 = 1;
sigmaeta4 = 1;
sigmaeta5 = 1;
beta = .99;
kappa = .05;
gamma = .1;
chipi = 1.5;
chiy = .125;
rho = .8;

    g0 = ...
    [
      1,0,sigma,0,-1,1,1,0,0,0,0,0,0,0,0,0,0;
      -kappa,0,0,0,0,-beta,1,0,0,0,0,0,0,0,0,0,0;
      -chiy, -chipi,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;
      1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;
    ];
g1 = ...
    [
      0,0,0,0,rho,0,0,0,0,0,1,0,0,1,0,1,0;
      0,kappa*gamma*rho,0,0,0,0,0,0,0,0,-kappa*gamma,0,0,-kappa*gamma,0,-kappa*gamma,0;
      0,0,0,-chiy*gamma*rho,0,0,0,0,0,0,-chiy*gamma,0,0,-chiy*gamma,0,-chiy*gamma,0;
      0,0,0,rho,0,0,0,1,0,0,1,0,0,1,0,1,0;
      0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;
      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
    ];
psi = ...
    [
    sigmae,0,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,sigmaeta1,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,sigmaeta2,0,0;
    0,0,0,0,0;
    0,0,0,0,0;
    0,0,0,sigmaeta3,0;
    0,0,0,0,0;
    0,0,0,0,sigmaeta4;
    ];
pi = ...
    [
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    1,0,0;
    0,1,0;
    0,0,1;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    0,0,0;
    ];

[r,c] = size(g0);
[F,~,G,~,~,~,~,eu,~] = gensys(g0,g1,0,psi,pi);

shock = ...
    [
    1;1;1;1;1
    ];

periods = 20;
out = systemResp(F,G,shock,periods);
figure(1)
subplot(4,1,1)
plot(1:periods+1, out(1,:))
title('Output Response')
subplot(4,1,2)
plot(1:periods+1, out(2,:))
title('Inflation Response')
subplot(4,1,3)
plot(1:periods+1, out(3,:))
title('Interest Rates Response')
subplot(4,1,4)
plot(1:periods+1, out(4,:))
title('Government Spending Response')







